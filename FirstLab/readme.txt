Для корректной работы алгоритма необходимо запускать через PyCharm.
Так и не понял по какой причине, но через обычный IDLE python вывод происходит некорректно.
Версия Python 3.6